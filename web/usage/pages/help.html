<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="../../styles/documentation.css" />
		<link rel="stylesheet" href="../../tools/markdown-converter/markdown-styles.css" />
		<link rel="icon" href="../../assets/img/icon.svg" type="image/svg+xml" /> <!-- Change the favicon here -->

		<!-- Apply dark mode immediately before body renders to prevent flashbang -->
		<script>
			(function () {
				const savedTheme = localStorage.getItem("theme");
				if (savedTheme === "dark") {
					document.documentElement.classList.add("dark-mode");
				}
			})();
		</script>

		<!-- defer module loading; page will import modules when needed -->
		<script type="module">
			import MarkdownConverter from "../../tools/markdown-converter/markdown-converter.js";

			// Light/Dark mode toggle function
			window.lightDarkModeToggle = function() {
				const html = document.documentElement;
				const toggleButton = document.getElementById("lightDarkToggle");
				const toggleIcon = toggleButton.querySelector(".icon");
				const toggleText = toggleButton.querySelector(".icon-text");

				html.classList.toggle("dark-mode");

				if (html.classList.contains("dark-mode")) {
					toggleIcon.src = "../../assets/img/light.svg";
					toggleText.textContent = "Light Mode";
					localStorage.setItem("theme", "dark");
				} else {
					toggleIcon.src = "../../assets/img/dark.svg";
					toggleText.textContent = "Dark Mode";
					localStorage.setItem("theme", "light");
				}
			};

			document.addEventListener("DOMContentLoaded", async () => {
				const converter = new MarkdownConverter([], []);
				const md = await converter.loadMarkdown("../../assets/pages/help.md");
				const html = converter.convert(md, "pages/help.md");
				document.getElementById("markdown-container").innerHTML = html;

				// Update button text based on saved theme
				const savedTheme = localStorage.getItem("theme");
				const toggleButton = document.getElementById("lightDarkToggle");
				if (savedTheme === "dark" && toggleButton) {
					toggleButton.innerHTML = '<img class="icon" src="../../assets/img/dark.svg" alt="modeswitch-icon"></img><span class="icon-text">Light Mode</span>';
				}
			});
		</script>
		<title>Help</title>
	</head>

	<body>
		<header>
			<div class="header-logo">
				<!-- Add a icon in the title here `<img src="../assets/img/icon.svg" class="header-image" alt="Logo" />` -->
				<p class="header-text-page">Help</p> <!-- Change the title here -->
				<div class="header-controls">
					<div class="header-search-bar" style="visibility: hidden">
						<img class="icon search-icon" src="../../assets/img/search.svg" alt="search-icon" />
						<input type="text" id="searchInput" placeholder="Search documentation..." disabled />
					</div>
					<button id="lightDarkToggle" onclick="lightDarkModeToggle()">
						<img class="icon" src="../../assets/img/light.svg" alt="modeswitch-icon" />
						<span class="icon-text">Dark Mode</span>
					</button>
				</div>
			</div>
		</header>

		<div class="side-line"></div>

		<main>
			<div class="display-window">
				<div id="markdown-container">
					<!-- Loading of MarkDown content will be placed here -->
				</div>
			</div>
		</main>
		<footer>
			<a href="index.html">Main Page</a>
		</footer>
	</body>
</html>
